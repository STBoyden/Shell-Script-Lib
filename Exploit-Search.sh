#!/bin/sh

date=$(date -u)
jtr=$(which john)
jnny=$(which johnny)
XHDA=$(which xhydra)
ARM=$(which armitage)
MSF=$(which metasploit)
nmp=$(which nmap)
zmp=$(which zenmap)
wshk=$(which wireshark)
nssus=$(which nessus)
acrk=$(which aircrack)
acrkng=$(which aircrack-ng)
snt=$(which snort)
CAB=$(which Cain and Abel)
BT=$(which BackTrack)
nc=$(which netcat)
tcpd=$(which tcpdump)
ksmt=$(which kismet)
nkto=$(which nikto)
bsuit=$(which Burpsuite)
hpng=$(which hping)
ecap=$(which ettercap)
sysints=$(which sysinternals)
w3af=$(which w3af)
scpy=$(which scpy)
hyda=$(which hydra)
pros=$(which paros)
oc=$(which ophcrack)
rc=$(which rainbowcrack)
msf=$(which metasploit-framework)
tlnt=$(which telnet)
ovas=$(which openvas)
oVAS=$(which openVAS)
nstmblr=$(which netstumbler)
nStmblr=$(which netStumbler)
amp=$(which Amap)
Amp=$(which amap)
sfh=$(which skipfish)
Sfh=$(which SkipFish)
Wpiti=$(which Wapiti)
wpiti=$(which wapiti)
Wfzz=$(which wfuzz)
nmsis=$(which nemisis)
Nmsis=$(which Nemisis)
Ysna=$(which Yersinia)
ysna=$(which yersinia)
Dnsf=$(which Dsniff)
dsnf=$(which dsniff)
EA=$(which EtherApe)
ea=$(which etherape)
isdr=$(which inssider)
ksmc=$(which kismac)
NM=$(which networkminer)
ngp=$(which ngrep)
ntp=$(which ntop)
pof=$(which p0f)
bts=$(which brutus)
fgd=$(which fgdump)
l0ck=$(which l0phtcrack)
mdsa=$(which medusa)
SW=$(which solarwinds)
SS=$(which superscan)
pvssh=$(which ssh)
pvwww=$(which www)
pvsamba=$(which samba)
pvvsftpd=$(which vsftpd)
pvftp=$(which ftp)
pvtcp=$(which tcp)
pvphp=$(which php)
pvsmtp=$(which smtp)
pvhttp=$(which http)
pvhttps=$(which https)
djohn=$(sudo dpkg -l | grep john)
djohnny=$(sudo dpkg -l | grep johnny)
dxhydra=$(sudo dpkg -l | grep xhydra)
darmitage=$(sudo dpkg -l | grep armitage)
dmetasploit=$(sudo dpkg -l | grep metasploit)
dnmap=$(sudo dpkg -l | grep nmap)
dzenmap=$(sudo dpkg -l | grep zenmap)
dwireshark=$(sudo dpkg -l | grep wireshark)
dnessus=$(sudo dpkg -l | grep nessus)
daircrack=$(sudo dpkg -l | grep aircrack-ng)
daircrackng=$(sudo dpkg -l | grep aircrack)
dcain=$(sudo dpkg -l | grep Cain)
dbacktrack=$(sudo dpkg -l | grep BackTrack)
dnetcat=$(sudo dpkg -l | grep netcat)
dtcpdump=$(sudo dpkg -l | grep tcpdump)
dkismet=$(sudo dpkg -l | grep kismet)
dnikto=$(sudo dpkg -l | grep nikto)
dburpsuite=$(sudo dpkg -l | grep burpsuite)
dhping=$(sudo dpkg -l | grep hping)
dettercap=$(sudo dpkg -l | grep ettercap)
dsysinternals=$(sudo dpkg -l | grep sysinternals)
dw3af=$(sudo dpkg -l | grep w3af)
dhydra=$(sudo dpkg -l | grep hydra)
dparos=$(sudo dpkg -l | grep paros )
dophcrack=$(sudo dpkg -l | grep ophcrack)
drainbowcrack=$(sudo dpkg -l | grep rainbowcrack)
dmetasploitframework=$(sudo dpkg -l | grep metasploit-framework)
dtelnet=$(sudo dpkg -l | grep telnet)
dopenvas=$(sudo dpkg -l | grep openvas)
dopenVAS=$(sudo dpkg -l | grep openVAS)
dnetStumbler=$(sudo dpkg -l | grep netStumbler)
dnetstumbler=$(sudo dpkg -l | grep netstumbler)
damap=$(sudo dpkg -l | grep amap)
dAmap=$(sudo dpkg -l | grep Amap)
dskipfish=$(sudo dpkg -l | grep skipfish)
dSkipFish=$(sudo dpkg -l | grep SkipFish)
dWapiti=$(sudo dpkg -l | grep Wapiti)
dwapiti=$(sudo dpkg -l | grep wapiti)
dWfuzz=$(sudo dpkg -l | grep Wfuzz)
dwfuzz=$(sudo dpkg -l | grep wfuzz)
dNemisis=$(sudo dpkg -l | grep Nemisis)
dnemisis=$(sudo dpkg -l | grep nemisis)
dyersinia=$(sudo dpkg -l | grep yersinia )
ddsniff=$(sudo dpkg -l | grep dsniff)
dDsniff=$(sudo dpkg -l | grep Dsniff)
dEtherApe=$(sudo dpkg -l | grep EtherApe)
dethrape=$(sudo dpkg -l | grep etherape)
dinSSIDer=$(sudo dpkg -l | grep inSSIDer)
dssider=$(sudo dpkg -l | grep inssider)
dKismac=$(sudo dpkg -l | grep KisMAC)
dKisMac=$(sudo dpkg -l | grep KisMac)
dKismca=$(sudo dpkg -l | grep Kismac)
dNetworkMiner=$(sudo dpkg -l | grep NetworkMiner)
dnetworkminer=$(sudo dpkg -l | grep networkminer)
dNgrep=$(sudo dpkg -l | grep Ngrep)
dngrep=$(sudo dpkg -l | grep ngrep)
dNtop=$(sudo dpkg -l | grep Ntop )
dntop=$(sudo dpkg -l | grep ntop)
dP0f=$(sudo dpkg -l | grep P0f)
dp0f=$(sudo dpkg -l | grep p0f)
dBrutus=$(sudo dpkg -l | grep Brutus)
dbrutus=$(sudo dpkg -l | grep brutus)
dFgdump=$(sudo dpkg -l | grep Fgdump)
dfgdump=$(sudo dpkg -l | grep fgdump)
dL0phtCrack=$(sudo dpkg -l | grep L0phtCrack) 
dl0phtcrack=$(sudo dpkg -l | grep l0phtcrack)
dMedusa=$(sudo dpkg -l | grep Medusa )
dmedusa=$(sudo dpkg -l | grep medusa )
dSolarWinds=$(sudo dpkg -l | grep SolarWinds)
dsolarwinds=$(sudo dpkg -l | grep solarwinds)
dSuperScan=$(sudo dpkg -l | grep SuperScan)
dSuperscan=$(sudo dpkg -l | grep Superscan)
dsuperscan=$(sudo dpkg -l | grep superscan)

if [ $(/usr/bin/id -u) -ne 0 ]; then
    echo "You must be root. This instance will be logged."
    echo "[FAIL] $USER attempted to run the search on $date." | sudo tee -a /bin/lib/sh/MK3S/logs/MK3S.log
    exit
fi

echo "POSSIBLE_EXPLOITS most recent check was on $date"
echo "Exploit-Search started on $date" | sudo tee -a /bin/lib/sh/MK3S/logs/MK3S.log
cd /bin/lib/sh/MK3S/data
touch Exploit-Search.txt
chmod 511 Exploit-Search.txt
cat /dev/null > Exploit-Search.txt
echo ----------Possible Pen-tools---------- | sudo tee -a Exploit-Search.txt
echo "$jtr"  | grep john  | sudo tee -a Exploit-Search.txt
echo "$jnny" | grep johnny | sudo tee -a Exploit-Search.txt
echo "$XHDA" | grep xhydra | sudo tee -a Exploit-Search.txt
echo "$ARM"  | grep armitage | sudo tee -a Exploit-Search.txt
echo "$MSF"  | grep metasploit  | sudo tee -a Exploit-Search.txt
echo "$nmp"  | grep nmap | sudo tee -a Exploit-Search.txt
echo "$zmp"  | grep zenmap | sudo tee -a Exploit-Search.txt
echo "$wshk" | grep wireshark  | sudo tee -a Exploit-Search.txt
echo "$nssus" | grep nessus | sudo tee -a Exploit-Search.txt
echo "$acrk" | grep aircrack | sudo tee -a Exploit-Search.txt
echo "$acrkng" | grep aircrack | sudo tee -a Exploit-Search.txt
echo "$snt" | grep snort  | sudo tee -a Exploit-Search.txt
echo "$CAB" | grep cain | sudo tee -a Exploit-Search.txt
echo "$BT" | grep backtrack | sudo tee -a Exploit-Search.txt
echo "$nc" | grep netcat | sudo tee -a Exploit-Search.txt
echo "$tcpd" | grep tcpdump | sudo tee -a Exploit-Search.txt
echo "$ksmt" | grep kismet | sudo tee -a Exploit-Search.txt
echo "$nkto" | grep nikto | sudo tee -a Exploit-Search.txt
echo "$bsui" | grep burpsuite | sudo tee -a Exploit-Search.txt
echo "$hpng" | grep hping | sudo tee -a Exploit-Search.txt
echo "$ecap" | grep ettercap | sudo tee -a Exploit-Search.txt
echo "$sysints" | grep sysinternals | sudo tee -a Exploit-Search.txt
echo "$w3af" | grep w3af | sudo tee -a Exploit-Search.txt
echo "$scpy" | grep scpy | sudo tee -a Exploit-Search.txt
echo "$hyda" | grep hydra | sudo tee -a Exploit-Search.txt
echo "$pros" | grep paros | sudo tee -a Exploit-Search.txt
echo "$oc"  | grep ophcrack | sudo tee -a Exploit-Search.txt 
echo "$rc" | grep rainbowcrack | sudo tee -a Exploit-Search.txt
echo "$msf" | grep metasploit | sudo tee -a Exploit-Search.txt
echo "$tlnt" | grep telnet | sudo tee -a Exploit-Search.txt
echo "$ovas" | grep openvas | sudo tee -a Exploit-Search.txt
echo "$oVAS" | grep openVAS  | sudo tee -a Exploit-Search.txt
echo "$nstmblr" | grep netstumbler | sudo tee -a Exploit-Search.txt
echo "$nStmblr" | grep netStumbler| sudo tee -a Exploit-Search.txt
echo "$amp" | grep amap | sudo tee -a Exploit-Search.txt
echo "$Amp" | grep Amap | sudo tee -a Exploit-Search.txt
echo "$sfh" | grep skipfish | sudo tee -a Exploit-Search.txt
echo "$Sfh" | grep SkipFish | sudo tee -a Exploit-Search.txt
echo "$Wpiti" | grep Wapiti | sudo tee -a Exploit-Search.txt
echo "$wpiti" | grep wapiti | sudo tee -a Exploit-Search.txt
echo "$Wfzz"  | grep Wfuzz | sudo tee -a Exploit-Search.txt
echo "$nmsis" | grep nemisis | sudo tee -a Exploit-Search.txt
echo "$Nmsis" | grep Nemisis | sudo tee -a Exploit-Search.txt
echo "$Ysna"  | grep Yersinia | sudo tee -a Exploit-Search.txt
echo "$ysna" | grep yersinia | sudo tee -a Exploit-Search.txt
echo "$Dnsf" | grep Dsniff | sudo tee -a Exploit-Search.txt
echo "$dsnf" | grep dsniff | sudo tee -a Exploit-Search.txt
echo "$EA"  | grep EtherApe | sudo tee -a Exploit-Search.txt
echo "$ea" | grep etherape | sudo tee -a Exploit-Search.txt
echo "$isdr" | grep inSSIDer | sudo tee -a Exploit-Search.txt
echo "$ksmc" | grep kismac | sudo tee -a Exploit-Search.txt
echo "$NM"  | grep NetworkMiner | sudo tee -a Exploit-Search.txt
echo "$ngp" | grep ngrep | sudo tee -a Exploit-Search.txt
echo "$ntp" | grep ntop | sudo tee -a Exploit-Search.txt
echo "$pof"  | grep p0f | sudo tee -a Exploit-Search.txt
echo "$bts" | grep Brutus | sudo tee -a Exploit-Search.txt
echo "$fgd" | grep fgdump | sudo tee -a Exploit-Search.txt
echo "$l0ck" | grep l0ck | sudo tee -a Exploit-Search.txt
echo "$mdsa" | grep medusa | sudo tee -a Exploit-Search.txt
echo "$SW" | grep SolarWinds | sudo tee -a Exploit-Search.txt
echo "$SS" | grep SuperScan | sudo tee -a Exploit-Search.txt
echo "$bsuit" | grep burpsuite | sudo tee -a Exploit-Search.txt
echo "-----Possible-Remote-Exploits-----"  | sudo tee -a Exploit-Search.txt
echo "$pvssh" | grep ssh | sudo tee -a Exploit-Search.txt
echo "$pvwww"  | grep www | sudo tee -a Exploit-Search.txt
echo "$pvsamba" | grep samba | sudo tee -a Exploit-Search.txt
echo "$pvvsftpd" | grep vsftpd | sudo tee -a Exploit-Search.txt
echo "$pvftp" | grep ftp | sudo tee -a Exploit-Search.txt
echo "$pvtcp" | grep tcp | sudo tee -a Exploit-Search.txt
echo "$pvphp" | grep php | sudo tee -a Exploit-Search.txt
echo "$pvsmtp" | grep smtp | sudo tee -a Exploit-Search.txt
echo "$pvhttp" | grep http | sudo tee -a Exploit-Search.txt
echo "$pvhttps" | grep https | sudo tee -a Exploit-Search.txt
echo "-----DPKG-----"  | sudo tee -a Exploit-Search.txt
echo "$dopenVAS" | grep openvas | sudo tee -a Exploit-Search.txt
echo "$dskipfish" | grep skipfish | sudo tee -a Exploit-Search.txt
echo "$dinSSIDer" | grep inssider | sudo tee -a Exploit-Search.txt
echo "$dnetworkminer" | grep networkminer | sudo tee -a Exploit-Search.txt
echo "$dSuperscan" | grep superscan | sudo tee -a Exploit-Search.txt
echo "$djohn"  | grep john | sudo tee -a Exploit-Search.txt
echo "$djohnny" | grep johnny | sudo tee -a Exploit-Search.txt
echo "$dxhydra"  | grep xhydra | sudo tee -a Exploit-Search.txt
echo "$darmitage" | grep armitage | sudo tee -a Exploit-Search.txt
echo "$dmetasploit" | grep metasploit | sudo tee -a Exploit-Search.txt
echo "$dnmap" | grep nmap | sudo tee -a Exploit-Search.txt
echo "$dzenmap" | grep zenmap | sudo tee -a Exploit-Search.txt
echo "$dwireshark" | grep wireshark | sudo tee -a Exploit-Search.txt
echo "$dnessus" | grep nessus | sudo tee -a Exploit-Search.txt
echo "$daircrack" | grep aircrack | sudo tee -a Exploit-Search.txt
echo "$daircrackng" | grep aircrack | sudo tee -a Exploit-Search.txt
echo "$dcain" | grep cain | sudo tee -a Exploit-Search.txt
echo "$dbacktrack" | grep backtrack | sudo tee -a Exploit-Search.txt
echo "$dnetcat" | grep netcat | sudo tee -a Exploit-Search.txt
echo "$dtcpdump" | grep tcpdump | sudo tee -a Exploit-Search.txt
echo "$dkismet" | grep kismet | sudo tee -a Exploit-Search.txt
echo "$dnikto" | grep nikto | sudo tee -a Exploit-Search.txt
echo "$dburpsuite" | grep burpsuite | sudo tee -a Exploit-Search.txt
echo "$dhping" | grep hping | sudo tee -a Exploit-Search.txt
echo "$dettercap" | grep ettercap | sudo tee -a Exploit-Search.txt
echo "$dsysinternals" | grep sysinternals | sudo tee -a Exploit-Search.txt
echo "$dw3af" | grep w3af | sudo tee -a Exploit-Search.txt
echo "$dhydra" | grep hyda | sudo tee -a Exploit-Search.txt
echo "$dparos" | grep paros | sudo tee -a Exploit-Search.txt
echo "$dophcrack" | grep ophcrack | sudo tee -a Exploit-Search.txt
echo "$drainbowcrack" | grep rainbowcrack | sudo tee -a Exploit-Search.txt
echo "$dmetasploitframework" | grep metasploit | sudo tee -a Exploit-Search.txt
echo "$dtelnet" | grep telnet | sudo tee -a Exploit-Search.txt
echo "$dopenvas" | grep openvas | sudo tee -a Exploit-Search.txt
echo "$vdopenVAS" | grep openvas | sudo tee -a Exploit-Search.txt
echo "$dnetStumbler" | grep netstumbler | sudo tee -a Exploit-Search.txt
echo "$dnetstumbler" | grep netstumbler | sudo tee -a Exploit-Search.txt
echo "$damap" | grep amap  | sudo tee -a Exploit-Search.txt
echo "$dAmap" | grep amap | sudo tee -a Exploit-Search.txt
echo "$dskipfis" | grep skipfish | sudo tee -a Exploit-Search.txt
echo "$dSkipFish" | grep skipfish | sudo tee -a Exploit-Search.txt
echo "$dWapiti" | grep wapiti | sudo tee -a Exploit-Search.txt
echo "$dwapiti" | grep wapiti | sudo tee -a Exploit-Search.txt
echo "$dWfuzz" | grep wfuzz | sudo tee -a Exploit-Search.txt
echo "$dwfuzz" | grep wfuzz | sudo tee -a Exploit-Search.txt
echo "$dNemisis" | grep nemisis | sudo tee -a Exploit-Search.txt
echo "$dnemisis" | grep nemisis | sudo tee -a Exploit-Search.txt
echo "$dyersinia" | grep yersinia | sudo tee -a Exploit-Search.txt
echo "$ddsniff" | grep dsniff | sudo tee -a Exploit-Search.txt
echo "$dDsniff" | grep dsniff | sudo tee -a Exploit-Search.txt
echo "$dEtherApe" | grep etherape | sudo tee -a Exploit-Search.txt
echo "$dethrape" | grep etherape | sudo tee -a Exploit-Search.txt
echo "$dinSSIDe" | grep inssider | sudo tee -a Exploit-Search.txt 
echo "$dssider" | grep inSSIDer | sudo tee -a Exploit-Search.txt
echo "$dKismac" | grep KisMAC | sudo tee -a Exploit-Search.txt
echo "$dKisMac" | grep kismac | sudo tee -a Exploit-Search.txt
echo "$dKismca" | grep kismac | sudo tee -a Exploit-Search.txt
echo "$dNetworkMiner" | grep networkminer | sudo tee -a Exploit-Search.txt
echo "$dnetworkmine"  | grep networkminer | sudo tee -a Exploit-Search.txt
echo "$dNgrep" | grep ngrep | sudo tee -a Exploit-Search.txt
echo "$dngrep" | grep ngrep | sudo tee -a Exploit-Search.txt
echo "$dNtop" | grep ntop | sudo tee -a Exploit-Search.txt
echo "$dntop" | grep ntop | sudo tee -a Exploit-Search.txt
echo "$dP0f" | grep p0f | sudo tee -a Exploit-Search.txt
echo "$dp0f" | grep p0f | sudo tee -a Exploit-Search.txt
echo "$dBrutus" | grep brutus | sudo tee -a Exploit-Search.txt
echo "$dbrutus" | grep brutus | sudo tee -a Exploit-Search.txt
echo "$dFgdump" | grep fgdump | sudo tee -a Exploit-Search.txt
echo "$dfgdump" | grep fgdump | sudo tee -a Exploit-Search.txt
echo "$dL0phtCrack" | grep l0phtcrack | sudo tee -a Exploit-Search.txt
echo "$dl0phtcrack" | grep l0phtcrack | sudo tee -a Exploit-Search.txt
echo "$dMedusa" | grep medusa | sudo tee -a Exploit-Search.txt
echo "$dmedusa" | grep medusa | sudo tee -a Exploit-Search.txt
echo "$dSolarWinds" | grep solarwinds | sudo tee -a Exploit-Search.txt
echo "$dsolarwinds" | grep solarwinds | sudo tee -a Exploit-Search.txt
echo "$dSuperScan" | grep superscan | sudo tee -a Exploit-Search.txt
echo "$dsuperscan" | grep superscan | sudo tee -a Exploit-Search.txt

apt=(cat /bin/lib/sh/MK3S/data/Exploit-Search.sh | grep -c ii) 
dpkg(cat /bin/lib/sh/MK3S/data/Exploit-Search.sh | grep -c /usr/)
echo "[SUCCESS] Found $apt different exploiting tools in apt and $dpkg tools in dpkg." | sudo tee -a /bin/lib/sh/MK3S/logs/MK3S.log
